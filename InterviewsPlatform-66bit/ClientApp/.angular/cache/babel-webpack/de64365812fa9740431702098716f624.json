{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/jexin/Desktop/projects/InterviewsPlatform-66bit/InterviewsPlatform-66bit/ClientApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { timer } from 'rxjs';\nimport { VideoRecorderService } from \"./services/videoRecorder.service\";\nimport { VideoSenderService } from \"./services/videoSender.service\";\nimport { VideoReceiverService } from \"./services/videoReceiver.service\";\nimport { SignalrVideoUploaderService } from \"./services/signalrVideoUploader.service\";\nimport { SignalrConnectorService } from \"./services/signalrConnector.service\";\nimport { SignalrQuestionsReceiver } from \"./services/signalrQuestionsReceiver\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./services/videoRecorder.service\";\nimport * as i2 from \"./services/videoReceiver.service\";\nimport * as i3 from \"./services/signalrQuestionsReceiver\";\nimport * as i4 from \"./services/signalrConnector.service\";\nimport * as i5 from \"@angular/router\";\nimport * as i6 from \"@angular/common/http\";\nexport class InterviewComponent {\n  constructor(recorderService, videoReceiverService, questionsReceiverService, connectorService, route, router, http) {\n    this.recorderService = recorderService;\n    this.videoReceiverService = videoReceiverService;\n    this.questionsReceiverService = questionsReceiverService;\n    this.connectorService = connectorService;\n    this.route = route;\n    this.router = router;\n    this.http = http;\n  }\n\n  ngOnDestroy() {\n    if (this.video) {\n      this.video.getVideoTracks().forEach(x => x.stop());\n    }\n\n    this.subscribe.unsubscribe();\n  }\n\n  visibilitychange() {\n    this.checkHiddenDocument();\n  }\n\n  checkHiddenDocument() {\n    if (document.hidden) {\n      console.log('hidden ', this.seconds);\n    } else {\n      console.log('visible ', this.seconds);\n    }\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    this.http.get(\"/api/interview\", {\n      responceType: 'text'\n    }).subscribe(console.log, console.log);\n\n    this.router.routeReuseStrategy.shouldReuseRoute = () => false;\n\n    this.interviewId = this.route.snapshot.paramMap.get(\"id\");\n    let video = this.videoReceiverService.getVideo();\n\n    if (video) {\n      video.then( /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator(function* (stream) {\n          _this.video = stream;\n          yield _this.connectorService.start(_this.interviewId);\n\n          _this.recorderService.record(stream);\n\n          console.log(yield _this.questionsReceiverService.getQuestions());\n          const source = timer(1000, 1000);\n          _this.subscribe = source.subscribe(x => _this.seconds = x);\n        });\n\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n    } else {\n      /* написать пользователю, что видео нужно разрешить */\n    }\n  }\n\n}\n\nInterviewComponent.ɵfac = function InterviewComponent_Factory(t) {\n  return new (t || InterviewComponent)(i0.ɵɵdirectiveInject(i1.VideoRecorderService), i0.ɵɵdirectiveInject(i2.VideoReceiverService), i0.ɵɵdirectiveInject(i3.SignalrQuestionsReceiver), i0.ɵɵdirectiveInject(i4.SignalrConnectorService), i0.ɵɵdirectiveInject(i5.ActivatedRoute), i0.ɵɵdirectiveInject(i5.Router), i0.ɵɵdirectiveInject(i6.HttpClient));\n};\n\nInterviewComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: InterviewComponent,\n  selectors: [[\"app-interview\"]],\n  hostBindings: function InterviewComponent_HostBindings(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵlistener(\"visibilitychange\", function InterviewComponent_visibilitychange_HostBindingHandler($event) {\n        return ctx.visibilitychange($event);\n      }, false, i0.ɵɵresolveDocument);\n    }\n  },\n  features: [i0.ɵɵProvidersFeature([VideoRecorderService, VideoSenderService, VideoReceiverService, SignalrVideoUploaderService, SignalrConnectorService, SignalrQuestionsReceiver])],\n  decls: 3,\n  vars: 1,\n  consts: [[1, \"text-center\"], [\"id\", \"container\"], [\"autoplay\", \"\", \"id\", \"videoElement\", 3, \"srcObject\"]],\n  template: function InterviewComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵelementStart(1, \"div\", 1);\n      i0.ɵɵelement(2, \"video\", 2);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"srcObject\", ctx.video);\n    }\n  },\n  encapsulation: 2\n});","map":{"version":3,"sources":["C:/Users/jexin/Desktop/projects/InterviewsPlatform-66bit/InterviewsPlatform-66bit/ClientApp/src/app/interview/interview.component.ts"],"names":["timer","VideoRecorderService","VideoSenderService","VideoReceiverService","SignalrVideoUploaderService","SignalrConnectorService","SignalrQuestionsReceiver","i0","i1","i2","i3","i4","i5","i6","InterviewComponent","constructor","recorderService","videoReceiverService","questionsReceiverService","connectorService","route","router","http","ngOnDestroy","video","getVideoTracks","forEach","x","stop","subscribe","unsubscribe","visibilitychange","checkHiddenDocument","document","hidden","console","log","seconds","ngOnInit","get","responceType","routeReuseStrategy","shouldReuseRoute","interviewId","snapshot","paramMap","getVideo","then","stream","start","record","getQuestions","source","ɵfac","InterviewComponent_Factory","t","ɵɵdirectiveInject","ActivatedRoute","Router","HttpClient","ɵcmp","ɵɵdefineComponent","type","selectors","hostBindings","InterviewComponent_HostBindings","rf","ctx","ɵɵlistener","InterviewComponent_visibilitychange_HostBindingHandler","$event","ɵɵresolveDocument","features","ɵɵProvidersFeature","decls","vars","consts","template","InterviewComponent_Template","ɵɵelementStart","ɵɵelement","ɵɵelementEnd","ɵɵadvance","ɵɵproperty","encapsulation"],"mappings":"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","sourcesContent":["import { timer } from 'rxjs';\r\nimport { VideoRecorderService } from \"./services/videoRecorder.service\";\r\nimport { VideoSenderService } from \"./services/videoSender.service\";\r\nimport { VideoReceiverService } from \"./services/videoReceiver.service\";\r\nimport { SignalrVideoUploaderService } from \"./services/signalrVideoUploader.service\";\r\nimport { SignalrConnectorService } from \"./services/signalrConnector.service\";\r\nimport { SignalrQuestionsReceiver } from \"./services/signalrQuestionsReceiver\";\r\nimport * as i0 from \"@angular/core\";\r\nimport * as i1 from \"./services/videoRecorder.service\";\r\nimport * as i2 from \"./services/videoReceiver.service\";\r\nimport * as i3 from \"./services/signalrQuestionsReceiver\";\r\nimport * as i4 from \"./services/signalrConnector.service\";\r\nimport * as i5 from \"@angular/router\";\r\nimport * as i6 from \"@angular/common/http\";\r\nexport class InterviewComponent {\r\n    constructor(recorderService, videoReceiverService, questionsReceiverService, connectorService, route, router, http) {\r\n        this.recorderService = recorderService;\r\n        this.videoReceiverService = videoReceiverService;\r\n        this.questionsReceiverService = questionsReceiverService;\r\n        this.connectorService = connectorService;\r\n        this.route = route;\r\n        this.router = router;\r\n        this.http = http;\r\n    }\r\n    ngOnDestroy() {\r\n        if (this.video) {\r\n            this.video.getVideoTracks().forEach(x => x.stop());\r\n        }\r\n        this.subscribe.unsubscribe();\r\n    }\r\n    visibilitychange() {\r\n        this.checkHiddenDocument();\r\n    }\r\n    checkHiddenDocument() {\r\n        if (document.hidden) {\r\n            console.log('hidden ', this.seconds);\r\n        }\r\n        else {\r\n            console.log('visible ', this.seconds);\r\n        }\r\n    }\r\n    ngOnInit() {\r\n        this.http.get(\"/api/interview\", { responceType: 'text' }).subscribe(console.log, console.log);\r\n        this.router.routeReuseStrategy.shouldReuseRoute = () => false;\r\n        this.interviewId = this.route.snapshot.paramMap.get(\"id\");\r\n        let video = this.videoReceiverService.getVideo();\r\n        if (video) {\r\n            video.then(async (stream) => {\r\n                this.video = stream;\r\n                await this.connectorService.start(this.interviewId);\r\n                this.recorderService.record(stream);\r\n                console.log(await this.questionsReceiverService.getQuestions());\r\n                const source = timer(1000, 1000);\r\n                this.subscribe = source.subscribe(x => this.seconds = x);\r\n            });\r\n        }\r\n        else { /* написать пользователю, что видео нужно разрешить */ }\r\n    }\r\n}\r\nInterviewComponent.ɵfac = function InterviewComponent_Factory(t) { return new (t || InterviewComponent)(i0.ɵɵdirectiveInject(i1.VideoRecorderService), i0.ɵɵdirectiveInject(i2.VideoReceiverService), i0.ɵɵdirectiveInject(i3.SignalrQuestionsReceiver), i0.ɵɵdirectiveInject(i4.SignalrConnectorService), i0.ɵɵdirectiveInject(i5.ActivatedRoute), i0.ɵɵdirectiveInject(i5.Router), i0.ɵɵdirectiveInject(i6.HttpClient)); };\r\nInterviewComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: InterviewComponent, selectors: [[\"app-interview\"]], hostBindings: function InterviewComponent_HostBindings(rf, ctx) { if (rf & 1) {\r\n        i0.ɵɵlistener(\"visibilitychange\", function InterviewComponent_visibilitychange_HostBindingHandler($event) { return ctx.visibilitychange($event); }, false, i0.ɵɵresolveDocument);\r\n    } }, features: [i0.ɵɵProvidersFeature([\r\n            VideoRecorderService,\r\n            VideoSenderService,\r\n            VideoReceiverService,\r\n            SignalrVideoUploaderService,\r\n            SignalrConnectorService,\r\n            SignalrQuestionsReceiver\r\n        ])], decls: 3, vars: 1, consts: [[1, \"text-center\"], [\"id\", \"container\"], [\"autoplay\", \"\", \"id\", \"videoElement\", 3, \"srcObject\"]], template: function InterviewComponent_Template(rf, ctx) { if (rf & 1) {\r\n        i0.ɵɵelementStart(0, \"div\", 0);\r\n        i0.ɵɵelementStart(1, \"div\", 1);\r\n        i0.ɵɵelement(2, \"video\", 2);\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n    } if (rf & 2) {\r\n        i0.ɵɵadvance(2);\r\n        i0.ɵɵproperty(\"srcObject\", ctx.video);\r\n    } }, encapsulation: 2 });\r\n"]},"metadata":{},"sourceType":"module"}