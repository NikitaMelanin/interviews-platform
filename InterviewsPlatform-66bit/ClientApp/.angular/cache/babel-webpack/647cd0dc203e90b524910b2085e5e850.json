{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/jexin/Desktop/projects/InterviewsPlatform-66bit/InterviewsPlatform-66bit/ClientApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { timer } from 'rxjs';\nimport { VideoRecorderService } from \"./services/videoRecorder.service\";\nimport { VideoSenderService } from \"./services/videoSender.service\";\nimport { VideoReceiverService } from \"./services/videoReceiver.service\";\nimport { SignalrVideoUploaderService } from \"./services/signalrVideoUploader.service\";\nimport { SignalrConnectorService } from \"./services/signalrConnector.service\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./services/videoRecorder.service\";\nimport * as i2 from \"./services/videoReceiver.service\";\nimport * as i3 from \"./services/signalrQuestionsReceiver\";\nimport * as i4 from \"./services/signalrConnector.service\";\nexport class InterviewComponent {\n  constructor(recorderService, videoReceiverService, questionsReceiverService, connectorService) {\n    this.recorderService = recorderService;\n    this.videoReceiverService = videoReceiverService;\n    this.questionsReceiverService = questionsReceiverService;\n    this.connectorService = connectorService;\n  }\n\n  ngOnDestroy() {\n    if (this.video) {\n      this.video.getVideoTracks().forEach(x => x.stop());\n    }\n\n    this.subscribe.unsubscribe();\n  }\n\n  visibilitychange() {\n    this.checkHiddenDocument();\n  }\n\n  checkHiddenDocument() {\n    if (document.hidden) {\n      console.log('hidden ', this.seconds);\n    } else {\n      console.log('visible ', this.seconds);\n    }\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    let video = this.videoReceiverService.getVideo();\n\n    if (video) {\n      video.then( /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator(function* (stream) {\n          _this.video = stream;\n          yield _this.connectorService.start();\n\n          _this.recorderService.record(stream);\n\n          _this.questionsReceiverService.getQuestions(\"\");\n\n          const source = timer(1000, 1000);\n          _this.subscribe = source.subscribe(x => _this.seconds = x);\n        });\n\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n    } else {\n      /* написать пользователю, что видео нужно разрешить */\n    }\n  }\n\n}\n\nInterviewComponent.ɵfac = function InterviewComponent_Factory(t) {\n  return new (t || InterviewComponent)(i0.ɵɵdirectiveInject(i1.VideoRecorderService), i0.ɵɵdirectiveInject(i2.VideoReceiverService), i0.ɵɵdirectiveInject(i3.SignalrQuestionsReceiver), i0.ɵɵdirectiveInject(i4.SignalrConnectorService));\n};\n\nInterviewComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: InterviewComponent,\n  selectors: [[\"app-interview\"]],\n  hostBindings: function InterviewComponent_HostBindings(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵlistener(\"visibilitychange\", function InterviewComponent_visibilitychange_HostBindingHandler($event) {\n        return ctx.visibilitychange($event);\n      }, false, i0.ɵɵresolveDocument);\n    }\n  },\n  features: [i0.ɵɵProvidersFeature([VideoRecorderService, VideoSenderService, VideoReceiverService, SignalrVideoUploaderService, SignalrConnectorService])],\n  decls: 3,\n  vars: 1,\n  consts: [[1, \"text-center\"], [\"id\", \"container\"], [\"autoplay\", \"\", \"id\", \"videoElement\", 3, \"srcObject\"]],\n  template: function InterviewComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵelementStart(1, \"div\", 1);\n      i0.ɵɵelement(2, \"video\", 2);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"srcObject\", ctx.video);\n    }\n  },\n  encapsulation: 2\n});","map":{"version":3,"sources":["C:/Users/jexin/Desktop/projects/InterviewsPlatform-66bit/InterviewsPlatform-66bit/ClientApp/src/app/interview/interview.component.ts"],"names":["timer","VideoRecorderService","VideoSenderService","VideoReceiverService","SignalrVideoUploaderService","SignalrConnectorService","i0","i1","i2","i3","i4","InterviewComponent","constructor","recorderService","videoReceiverService","questionsReceiverService","connectorService","ngOnDestroy","video","getVideoTracks","forEach","x","stop","subscribe","unsubscribe","visibilitychange","checkHiddenDocument","document","hidden","console","log","seconds","ngOnInit","getVideo","then","stream","start","record","getQuestions","source","ɵfac","InterviewComponent_Factory","t","ɵɵdirectiveInject","SignalrQuestionsReceiver","ɵcmp","ɵɵdefineComponent","type","selectors","hostBindings","InterviewComponent_HostBindings","rf","ctx","ɵɵlistener","InterviewComponent_visibilitychange_HostBindingHandler","$event","ɵɵresolveDocument","features","ɵɵProvidersFeature","decls","vars","consts","template","InterviewComponent_Template","ɵɵelementStart","ɵɵelement","ɵɵelementEnd","ɵɵadvance","ɵɵproperty","encapsulation"],"mappings":"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","sourcesContent":["import { timer } from 'rxjs';\r\nimport { VideoRecorderService } from \"./services/videoRecorder.service\";\r\nimport { VideoSenderService } from \"./services/videoSender.service\";\r\nimport { VideoReceiverService } from \"./services/videoReceiver.service\";\r\nimport { SignalrVideoUploaderService } from \"./services/signalrVideoUploader.service\";\r\nimport { SignalrConnectorService } from \"./services/signalrConnector.service\";\r\nimport * as i0 from \"@angular/core\";\r\nimport * as i1 from \"./services/videoRecorder.service\";\r\nimport * as i2 from \"./services/videoReceiver.service\";\r\nimport * as i3 from \"./services/signalrQuestionsReceiver\";\r\nimport * as i4 from \"./services/signalrConnector.service\";\r\nexport class InterviewComponent {\r\n    constructor(recorderService, videoReceiverService, questionsReceiverService, connectorService) {\r\n        this.recorderService = recorderService;\r\n        this.videoReceiverService = videoReceiverService;\r\n        this.questionsReceiverService = questionsReceiverService;\r\n        this.connectorService = connectorService;\r\n    }\r\n    ngOnDestroy() {\r\n        if (this.video) {\r\n            this.video.getVideoTracks().forEach(x => x.stop());\r\n        }\r\n        this.subscribe.unsubscribe();\r\n    }\r\n    visibilitychange() {\r\n        this.checkHiddenDocument();\r\n    }\r\n    checkHiddenDocument() {\r\n        if (document.hidden) {\r\n            console.log('hidden ', this.seconds);\r\n        }\r\n        else {\r\n            console.log('visible ', this.seconds);\r\n        }\r\n    }\r\n    ngOnInit() {\r\n        let video = this.videoReceiverService.getVideo();\r\n        if (video) {\r\n            video.then(async (stream) => {\r\n                this.video = stream;\r\n                await this.connectorService.start();\r\n                this.recorderService.record(stream);\r\n                this.questionsReceiverService.getQuestions(\"\");\r\n                const source = timer(1000, 1000);\r\n                this.subscribe = source.subscribe(x => this.seconds = x);\r\n            });\r\n        }\r\n        else { /* написать пользователю, что видео нужно разрешить */ }\r\n    }\r\n}\r\nInterviewComponent.ɵfac = function InterviewComponent_Factory(t) { return new (t || InterviewComponent)(i0.ɵɵdirectiveInject(i1.VideoRecorderService), i0.ɵɵdirectiveInject(i2.VideoReceiverService), i0.ɵɵdirectiveInject(i3.SignalrQuestionsReceiver), i0.ɵɵdirectiveInject(i4.SignalrConnectorService)); };\r\nInterviewComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: InterviewComponent, selectors: [[\"app-interview\"]], hostBindings: function InterviewComponent_HostBindings(rf, ctx) { if (rf & 1) {\r\n        i0.ɵɵlistener(\"visibilitychange\", function InterviewComponent_visibilitychange_HostBindingHandler($event) { return ctx.visibilitychange($event); }, false, i0.ɵɵresolveDocument);\r\n    } }, features: [i0.ɵɵProvidersFeature([\r\n            VideoRecorderService,\r\n            VideoSenderService,\r\n            VideoReceiverService,\r\n            SignalrVideoUploaderService,\r\n            SignalrConnectorService\r\n        ])], decls: 3, vars: 1, consts: [[1, \"text-center\"], [\"id\", \"container\"], [\"autoplay\", \"\", \"id\", \"videoElement\", 3, \"srcObject\"]], template: function InterviewComponent_Template(rf, ctx) { if (rf & 1) {\r\n        i0.ɵɵelementStart(0, \"div\", 0);\r\n        i0.ɵɵelementStart(1, \"div\", 1);\r\n        i0.ɵɵelement(2, \"video\", 2);\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n    } if (rf & 2) {\r\n        i0.ɵɵadvance(2);\r\n        i0.ɵɵproperty(\"srcObject\", ctx.video);\r\n    } }, encapsulation: 2 });\r\n"]},"metadata":{},"sourceType":"module"}